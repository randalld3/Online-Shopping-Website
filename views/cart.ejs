<!DOCTYPE html>
<html>
<head>
  <title>Glasses Shopping Portal Home</title>
  <link rel='stylesheet' href='/stylesheets/common.css' />
  <link rel='stylesheet' href='/stylesheets/cart.css' />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
</head>
<body>

  <!-- Header Section -->
  <header class="header">
    <img src="/images/filter.png" class="header_icon" data-toggle="modal" data-target="#sidebar-modal">
    <a href="/">
      <img src="/images/logo_temp.png" class="header_icon logo">
    </a>
    <form class="search-form" action="/search" method="GET">
      <input type="text" class="search_bar" name="q" placeholder="Search" required>
      <button type="submit" class="search-btn">Search</button>
    </form>
    <a href="/profile">
      <img src="/images/profile.jpg" class="header_icon">
    </a>
    <a href="/cart">
      <img src="/images/cart.jpg" class="header_icon">
    </a>
  </header>

  <!-- Main Content -->
  <div class="cart-header">
    Your Cart:
  </div>
  <% let total = 0 %>
  <% let total_qty = 0 %>
  <% Object.keys(cart).forEach(productName => { %>
    <% const quantity = cart[productName] %>
    <% const pricePerUnit = price[productName] %>

    <div class="product-section">
      <div class="product-image-container">
          <img src="/images/<%= productName %>.jpg" class="product-image">
      </div>
      <div class="product-details">
        <div class="product-name">
          <%= productName %>
        </div>
        <div class="product-price">
          Price: $<%= pricePerUnit %>
        </div>
        <div class="quantity-update">
          <form method="post" action="/cart/update">
            <label for="qty" class="quantity-label">Qty:</label>
            <input type="hidden" name="name" value="<%= productName %>">
            <input type="number" id="<%= productName %>-qty" name="qty" class="quantity-input" min="0" value="<%= quantity %>">
            <button type="submit" class="update-cart-btn">Update</button>
          </form>
        </div>
        <div class="product-subtotal">
          Subtotal: $<%= (pricePerUnit * quantity).toFixed(2) %>
          <% total = total + (pricePerUnit * quantity) %>
          <% total_qty = total_qty +  quantity %>
        </div>
      </div>
    </div>
  <% }); %>
  
  <div class="summary-header">
      Cart Summary
  </div>
  <div class="cart-summary">
    <div class="cart-totals">
      <div>Subtotal: $<%= (total).toFixed(2) %></div>
      <div>Number of Items: <%= total_qty %></div>
    </div>
    <div class="proceed-to-checkout-btn-container">
      <a href="/checkout" class="proceed-to-checkout-btn">
        <button type="button">Proceed to Checkout -></button>
      </a>
    </div>
  </div>
  

  <!-- Footer Section -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <a href="/returns" class="footer-link">Returns</a>
          <a href="/faq" class="footer-link">FAQ</a>
        </div>
        <div class="col-md-6">
          <a href="/shipping" class="footer-link">Shipping</a>
          <a href="/contact" class="footer-link">Contact Us</a>
        </div>
      </div>
      <div class="row justify-content-center social-media-row">
        <div class="col-auto">
          <a href="https://facebook.com" class="footer-icon"><img src="/images/facebook-icon.png" alt="Facebook"></a>
        </div>
        <div class="col-auto">
          <a href="https://twitter.com" class="footer-icon"><img src="/images/twitter-icon.png" alt="Twitter"></a>
        </div>
        <div class="col-auto">
          <a href="https://instagram.com" class="footer-icon"><img src="/images/instagram-icon.png" alt="Instagram"></a>
        </div>
        <div class="col-auto">
          <a href="https://tiktok.com" class="footer-icon"><img src="/images/tiktok-icon.png" alt="TikTok"></a>
        </div>
      </div>
    </div>
  </footer>

<!-- Sidebar Modal -->
<%- include('sidebar') %>
  
<script src="/javascripts/product.js"></script>
</body>
</html>
